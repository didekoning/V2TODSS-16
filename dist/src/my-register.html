<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<!--
<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="shared-styles.html">
-->

<!-- <script src="../auth/auth.js"></script> -->

<dom-module id="my-register">
	<template>
		<style include="shared-styles">
			:host {
			display: block;

			padding: 10px;
			}
		</style>

	<firebase-auth id="auth" user="{{user}}" on-error="handleError" status-known="{{statusKnown}}">
	<iron-location id="ironLocation"></iron-location>

	<div class="card" id="register">
		<h1>Registreren</h1>
		<div class="error" hidden$="[[!message]]">[[message]]</div>
		<form on-submit="signInWithEmailAndPassword">
			<paper-input value="{{email}}" type="email" placeholder="Email"></paper-input>
			<paper-input value="{{password}}" type="password" placeholder="Password"></paper-input>
			<paper-button raised on-tap="createUserWithEmailAndPassword">Sign Up</paper-button>
		</form>

	</div>
	</template>

	<script>
		Polymer({
			is: 'my-register',
			properties: {
				message: {
					type: String,
					value: '',
				},
				email:{
					type: String,
					value: '',
				},
				password: {
					type: String,
					value: '',
				},
				user: {
					type: Object,
					notify: true,
				},
				custom: {
					type: Object,	
				},
			},
			loginSuccess: function(){
				this.custom['status'] = 1;
				if(this.custom['status'] == 1){
					this.$.ironLocation.set('path', '/profile');
				}
			},
			createUserWithEmailAndPassword: function() {
				this.error = null;
				this.$.auth.createUserWithEmailAndPassword(this.email, this.password) 
					.then((response) => { 
						this.loginSuccess(); 
						console.log("success"); 
					})
					.catch((response) => {
						console.log(response); 
					});
				this.password = null;
			},
			handleError: function(e) {
				this.message = 'Error: ' + e.detail.message;
			},
			signOut: function() {
				this.error = null;
				this.$.auth.signOut();
			},	
		});
	</script>
</dom-module>
