
<dom-module id="tys-chat">
	<template>
		<style>
			:host {
				display: inline-block;
				position: relative;
				width: 100%;
				border-bottom: 1px solid #e0e0e0;
				font-size: 16px;
				min-height: 700px;
				max-height: 700px;
				z-index: 0;

			}
			.user-list {
				padding: 16px;
			}
			.status {
				position: absolute;
				bottom: -3px;
				right: -3px;
				border-radius: 50%;
				width: 14px;
				height: 14px;
				background-color: #7EDF25;
				display: none;
			}
			.status.online {
				display: block;
			}
			.username {
				text-transform: capitalize;
				font-weight: 500;
				color: #919191;
				line-height: 1.3em;
				max-width: 90%;
				text-overflow: ellipsis;
				overflow: hidden;
				white-space: nowrap;
			}
			.timestamp {
				font-size: 0.75em;
				color: #919191;
			}
			.avatar {
				border: solid 3px silver;
			}
			.avatar.navy {
				border-color: #393b79;
			}
			.avatar.slate {
				border-color: #6b6ecf;
			}
			.avatar.olive {
				border-color: #637939;
			}
			.avatar.moss {
				border-color: #b5cf6b;
			}
			.avatar.chocolate {
				border-color: #8c6d31;
			}
			.avatar.buttercup {
				border-color: #e7ba52;
			}
			.avatar.maroon {
				border-color: #843c39;
			}
			.avatar.cerise {
				border-color: #d6616b;
			}
			.avatar.plum {
				border-color: #7b4173;
			}
			.avatar.orchid {
				border-color: #ce6dbd;
			}
		</style>

		<firebase-query
		id="document"
		path="/chat/{{chatid}}"
		data="{{data}}">
	</firebase-query>
	<section class="user-list" layout horizontal>
		<template is="dom-repeat" items="{{data}}">
			<div flex>
				<div class="username">{{item.name}}: </div>
				<div class="text">{{item.text}}</div>
			</div>

		</section>
	</template>


	<div class="send-message" layout horizontal>
		<paper-input flex label="Schrijf een bericht..." id="messagefield" value="{{mssginpt}}" style="width: 94%;float: left;"></paper-input>
		<paper-fab icon="send" id="sendButton" mini on-tap="_SendMessage"></paper-fab>
	</div>

</template>
<script>
	Polymer({     
		is: 'tys-chat', 
		properties: {
			data: {
				type: Object,
				chatid: String,
				observer: "_observer"
			},
			mssginpt:{
				type: String,
			},
			SendMessage:{
				observer: "_SendMessage"
			},
			custom:{
                    type: Object,
                },
            chatid:{
            		type:String,
            }
		},
		_observer: function(){
			console.log(this.data);
		},
		_SendMessage: function(mssginpt) {
			database = firebase.database();
			messagesRef = database.ref('/chat/'+ this.chatid + '/');
			if(this.$.messagefield.value != ""){
			messagesRef.push({
		      name: this.custom.achternaam,
		      text: this.$.messagefield.value
		  });
			this.$.messagefield.value = "";
			this.$.document.initializeStoredValue();
		};
		}
	});
</script>
</dom-module>